---
title: "Untitled"
format: html
editor: visual
---

## Libraries

```{r}
#| message: false
#| warning: false
library(readxl)
library(tidyverse)

```

## Data Import

```{r}

satis <- 
  read_excel("data/satis.xls") |> 
  set_names(c("year_month", "product_name", "quantity", "net_amount"))

stok <- read_excel("data/stok.xls")

```

## First Trials for joining

```{r}
stok_selected <- 
  stok |> 
    select(4,5) |> 
    set_names(c("product_name","stock_quantity"))


```

```{r}

duration <-yday(today())-1

monthly_sales <-
  satis |> 
    pivot_wider(
      names_from = year_month,
      values_from = c(quantity,net_amount)
    ) |> 
    mutate(
      quantity = rowSums(across(c(2, 3, 4, 5)), na.rm = TRUE)/duration*30,
      amount = rowSums(across(c(6, 7, 8, 9)), na.rm = TRUE)/duration*30
    ) |> 
    select(product_name,quantity,amount) |> 
    filter(!is.na(product_name)) |> 
    mutate(
      quantity=ceiling(quantity),
      amount=ceiling(amount)
    )
```
